<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whale Behavior Analysis | AML Presentation</title>
    <link rel="stylesheet" href="css/presentation.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <h1>Whale Behavior Analysis</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#visualizations" class="active">Visualizations</a></li>
                    <li><a href="#dive-frames">Dive Frames</a></li>
                    <li><a href="#classification">Classification</a></li>
                    <li><a href="#architecture">Architecture</a></li>
                    <li><a href="#technical">Technical Details</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Main Visualization Section -->
        <section id="visualizations">
            <h2 class="section-title">Whale Dive Visualizations</h2>
            
            <div class="viz-container">
                <div class="viz-header">
                    <h3>Interactive Visualization Dashboard</h3>
                </div>
                
                <div class="viz-controls">
                    <div class="btn-group">
                        <button class="btn viz-btn active" data-viz="overview">Overview</button>
                        <button class="btn viz-btn" data-viz="metrics">Metrics</button>
                        <button class="btn viz-btn" data-viz="energetics">Energetics</button>
                        <button class="btn viz-btn" data-viz="dive">Individual Dive</button>
                    </div>
                    
                    <div class="dive-selector">
                        <label for="dive-select">Select Dive:</label>
                        <select id="dive-select">
                            <option value="1">Dive 1</option>
                            <option value="2">Dive 2</option>
                            <option value="3">Dive 3</option>
                            <!-- Generate options for dives 4-128 -->
                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const diveSelect = document.getElementById('dive-select');
                                    // Already added dives 1-3, now add 4-128
                                    for (let i = 4; i <= 128; i++) {
                                        const option = document.createElement('option');
                                        option.value = i;
                                        option.textContent = `Dive ${i}`;
                                        diveSelect.appendChild(option);
                                    }
                                });
                            </script>
                        </select>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn feature-toggle active" data-feature="depth">Depth</button>
                        <button class="btn feature-toggle" data-feature="orientation">Orientation</button>
                        <button class="btn feature-toggle" data-feature="phases">Phases</button>
                        <button class="btn feature-toggle" data-feature="metrics">Metrics</button>
                    </div>
                </div>
                
                <iframe id="viz-frame" class="viz-frame" src="dashboard/overview.html"></iframe>
            </div>
        </section>

        <!-- Dive Frames Section -->
        <section id="dive-frames">
            <h2 class="section-title">Dive Frame Analysis</h2>
            
            <div class="technical-section">
                <h3>Static Visualization of Dive Data</h3>
                <p>The following overview shows 128 detected dives, with depth and relative twistiness visualized:</p>
                
                <div class="overview-image">
                    <img src="assets/dive_overview.png" alt="Overview of 128 detected dives" style="width: 100%; max-width: 1200px;">
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-target="individual-frames">Individual Frames</div>
                    <div class="tab" data-target="energetics-view">Energetics View</div>
                </div>
                
                <div id="individual-frames" class="tab-content active">
                    <h3>Individual Dive Frames</h3>
                    <p>Select a dive to view its static frame:</p>
                    
                    <select id="frame-select" onchange="document.getElementById('selected-frame').src = 'assets/dive_frames/dive_' + this.value.padStart(3, '0') + '.png'">
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const frameSelect = document.getElementById('frame-select');
                                for (let i = 1; i <= 128; i++) {
                                    const option = document.createElement('option');
                                    option.value = i;
                                    option.textContent = `Dive ${i}`;
                                    frameSelect.appendChild(option);
                                }
                            });
                        </script>
                    </select>
                    
                    <div class="frame-display">
                        <img id="selected-frame" src="assets/dive_frames/dive_001.png" alt="Selected dive frame" style="width: 100%; max-width: 800px; margin-top: 20px;">
                    </div>
                </div>
                
                <div id="energetics-view" class="tab-content">
                    <h3>Dive Energetics Overview</h3>
                    <p>This visualization shows the energetic expenditure across all dives:</p>
                    
                    <div class="energetics-image">
                        <img src="assets/dive_energetics.png" alt="Dive energetics visualization" style="width: 100%; max-width: 1200px;">
                    </div>
                </div>
            </div>
        </section>

        <!-- Classification Section -->
        <section id="classification">
            <h2 class="section-title">Classification Results</h2>
            
            <div class="technical-section">
                <h3>Whale Behavior Classification</h3>
                
                <div class="tabs">
                    <div class="tab active" data-target="training-results">Training Results</div>
                    <div class="tab" data-target="class-imbalance">Class Imbalance</div>
                    <div class="tab" data-target="validation-challenges">Validation Challenges</div>
                </div>
                
                <div id="training-results" class="tab-content active">
                    <div class="markdown-content" data-md-file="presentation/training_summary.md">
                        <!-- Content will be loaded from markdown -->
                        <p>Loading training results...</p>
                    </div>
                </div>
                
                <div id="class-imbalance" class="tab-content">
                    <h3>Addressing Class Imbalance</h3>
                    <p>Our dataset exhibits significant class imbalance in whale behaviors:</p>
                    
                    <ul>
                        <li>Exploratory dives: 216 samples (36.06%)</li>
                        <li>Feeding loop: 34 samples (5.68%)</li>
                        <li>Kick feeding: 53 samples (8.85%)</li>
                        <li>Noodle feeding: 114 samples (19.03%)</li>
                        <li>Side rolls: 112 samples (18.70%)</li>
                        <li>Side rolls and loop: 15 samples (2.50%)</li>
                        <li>Surface active: 33 samples (5.51%)</li>
                        <li>Traveling: 16 samples (2.67%)</li>
                        <li>Vertical loop: 6 samples (1.00%)</li>
                    </ul>
                    
                    <h4>Solutions Implemented:</h4>
                    <ol>
                        <li><strong>SMOTE Augmentation:</strong> Generated synthetic examples for minority classes</li>
                        <li><strong>Class Weights:</strong> Applied inverse frequency weighting in loss function</li>
                        <li><strong>Hierarchical Grouping:</strong> Grouped behaviors into higher-level categories</li>
                    </ol>
                </div>
                
                <div id="validation-challenges" class="tab-content">
                    <h3>Validation Challenges</h3>
                    <p>Several challenges affect the validation of our model:</p>
                    
                    <h4>Limited Ground Truth Data</h4>
                    <p>With only 599 labeled windows across all behaviors, we have insufficient data for robust validation, especially for rare classes.</p>
                    
                    <h4>Cross-Validation Limitations</h4>
                    <p>Traditional k-fold cross-validation is problematic due to temporal dependencies in whale behavior sequences.</p>
                    
                    <h4>Proposed Solutions:</h4>
                    <ol>
                        <li><strong>Leave-One-Out Validation:</strong> Training on all whales except one, testing on the held-out whale</li>
                        <li><strong>Time-Series Segmentation:</strong> Ensuring training and validation sets don't contain adjacent temporal segments</li>
                        <li><strong>Uncertainty Quantification:</strong> Implementing Bayesian approaches to quantify prediction confidence</li>
                    </ol>
                </div>
            </div>
        </section>

        <!-- Architecture Section -->
        <section id="architecture">
            <h2 class="section-title">Model Architecture</h2>
            
            <div class="technical-section">
                <h3>minGRU Implementation</h3>
                
                <div class="tabs">
                    <div class="tab active" data-target="mingru-overview">minGRU Overview</div>
                    <div class="tab" data-target="architecture-search">Architecture Search</div>
                </div>
                
                <div id="mingru-overview" class="tab-content active">
                    <h3>Minimal Gated Recurrent Unit (minGRU)</h3>
                    
                    <p>Our implementation uses a minimal GRU architecture optimized for efficient processing of temporal sensor data:</p>
                    
                    <pre><code>class MinGRU(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers=1, dropout=0.0):
        super(MinGRU, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        
        # Reset gate
        self.reset_gates = nn.ModuleList([
            nn.Linear(input_size + hidden_size, hidden_size) if i == 0 
            else nn.Linear(hidden_size + hidden_size, hidden_size) 
            for i in range(num_layers)
        ])
        
        # Update gate
        self.update_gates = nn.ModuleList([
            nn.Linear(input_size + hidden_size, hidden_size) if i == 0 
            else nn.Linear(hidden_size + hidden_size, hidden_size) 
            for i in range(num_layers)
        ])
        
        # Candidate activation
        self.candidates = nn.ModuleList([
            nn.Linear(input_size + hidden_size, hidden_size) if i == 0 
            else nn.Linear(hidden_size + hidden_size, hidden_size) 
            for i in range(num_layers)
        ])
        
        self.dropout = nn.Dropout(dropout)
        
    def forward(self, x, hidden=None):
        batch_size, seq_len, input_size = x.size()
        
        if hidden is None:
            hidden = [torch.zeros(batch_size, self.hidden_size, device=x.device) 
                    for _ in range(self.num_layers)]
        
        outputs = []
        for t in range(seq_len):
            x_t = x[:, t, :]
            
            layer_input = x_t
            new_hidden = []
            
            for layer in range(self.num_layers):
                h_prev = hidden[layer]
                
                # Compute gate inputs
                combined = torch.cat((layer_input, h_prev), dim=1)
                
                # Reset gate
                r_t = torch.sigmoid(self.reset_gates[layer](combined))
                
                # Update gate
                z_t = torch.sigmoid(self.update_gates[layer](combined))
                
                # Candidate activation
                reset_hidden = r_t * h_prev
                candidate_input = torch.cat((layer_input, reset_hidden), dim=1)
                h_tilde = torch.tanh(self.candidates[layer](candidate_input))
                
                # Hidden state update
                h_t = (1 - z_t) * h_prev + z_t * h_tilde
                
                # Apply dropout (except on the last layer)
                if layer < self.num_layers - 1:
                    layer_input = self.dropout(h_t)
                else:
                    layer_input = h_t
                
                new_hidden.append(h_t)
            
            hidden = new_hidden
            outputs.append(layer_input)
        
        outputs = torch.stack(outputs, dim=1)
        return outputs, hidden</code></pre>
                    
                    <h4>Key Advantages:</h4>
                    <ul>
                        <li><strong>Efficiency:</strong> 39,690 trainable parameters, compared to ~120,000 for standard GRU</li>
                        <li><strong>Memory Usage:</strong> Reduced by eliminating the full reset gate multiplication</li>
                        <li><strong>Training Speed:</strong> ~45 seconds per epoch on Apple Silicon</li>
                    </ul>
                </div>
                
                <div id="architecture-search" class="tab-content">
                    <div class="markdown-content" data-md-file="presentation/architecture_search.md">
                        <!-- Content will be loaded from markdown -->
                        <p>Loading architecture search information...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Technical Details Section -->
        <section id="technical">
            <h2 class="section-title">Technical Implementation</h2>
            
            <div class="technical-section">
                <div class="tabs">
                    <div class="tab active" data-target="feature-transformation">Feature Transformation</div>
                    <div class="tab" data-target="pipeline-details">Pipeline Details</div>
                </div>
                
                <div id="feature-transformation" class="tab-content active">
                    <div class="markdown-content" data-md-file="presentation/feature_matrix_transformation.md">
                        <!-- Content will be loaded from markdown -->
                        <p>Loading feature transformation details...</p>
                    </div>
                </div>
                
                <div id="pipeline-details" class="tab-content">
                    <h3>Pipeline Implementation</h3>
                    
                    <p>Our whale behavior analysis pipeline consists of several key components:</p>
                    
                    <ol>
                        <li><strong>Data Loading:</strong> HDF5 file parsing for multi-dimensional sensor data</li>
                        <li><strong>Feature Extraction:</strong> Statistical and domain-specific features</li>
                        <li><strong>Windowing:</strong> 100-point windows with 50% overlap</li>
                        <li><strong>Class Balancing:</strong> SMOTE augmentation and class weights</li>
                        <li><strong>Model Training:</strong> minGRU with optimized hyperparameters</li>
                        <li><strong>Visualization:</strong> Interactive and static representations</li>
                    </ol>
                    
                    <h4>Computational Optimization</h4>
                    <p>To ensure efficient processing on personal hardware:</p>
                    <ul>
                        <li>Metal Performance Shaders (MPS) for Apple Silicon GPU acceleration</li>
                        <li>Parallel prefix sum algorithm for feature computation</li>
                        <li>Memory-efficient implementations to handle large time series</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>Applied Machine Learning | Whale Behavior Analysis Project | 2023</p>
        </div>
    </footer>

    <script src="js/presentation.js"></script>
</body>
</html> 